# Web Exploitation

# Cookies ( Burp intruder )

---

<aside>
💡 Burp Intruder is a powerful tool for performing highly customizable, automated attacks against websites. It enables you to configure attacks that send the same request over and over again, inserting different payloads into predefined positions each time. Among 
other things, you can use Intruder to:

- Fuzz for input-based vulnerabilities.
- Perform brute-force attacks.
- Enumerate valid identifiers and other inputs.
- Harvest useful data.
</aside>

![Untitled](Web%20Exploitation%201f6ab152e9b44ed5bdde9b2f82e11f9e/Untitled.png)

# Information leak

---

How can I keep Google from indexing my website?

<aside>
💡 Web crawling, indexing and ranking

</aside>

<aside>
💡 ./robots.txt —> put what you don’t want others to see

</aside>

<aside>
💡 ./.htaccess —> Apache

</aside>

<aside>
💡 ./.DS_Store —> Mac

</aside>

## 版本控制

```jsx
版本控制
/.git/config
/.env
/.svn
/.bzr
```

[https://github.com/lijiejie/GitHack](https://github.com/lijiejie/GitHack)

## Vim 暫存檔

```jsx
/a.php.swp
```

## Backup files

```jsx
www.tar.gz
backup.zip
```

# **Who are you? ( http header )**

---

<aside>
💡 User-Agent —> browser

</aside>

<aside>
💡 Referer —> absolute or partial address from which a resource has been requested

</aside>

<aside>
💡 Date —> the date and time at which the message was generated

</aside>

<aside>
💡 DNT —> allows users to choose if their activity could be tracked by each server and web application that they communicate with via HTTP

</aside>

<aside>
💡 X-Forwarded-For —> provides the client's IP address or a chain of proxy server IP addresses, and helps identify the true client IP address when requests pass through multiple proxies.

**IP Address Ranges by Country —> use different ip address indicate where you are**

</aside>

# **Search source (wget -r)**

---

<aside>
💡 mirror the website on local machine —> wget -r

</aside>

<aside>
💡 search for text —> grep “pico” -r *

</aside>

# **Roboto Sans ( robots.txt )**

---

Always don’t forget to check robots.txt

# **Secrets ( wget restrictions )**

---

<aside>
💡 open .jpg —> display example.jpg

</aside>

<aside>
💡 wget can’t get the hidden files ( web pages )

</aside>

# **Irish-Name-Repo 1 ( SQL injection )**

---

<aside>
💡 ‘ OR 1=1 --

</aside>

![Untitled](Web%20Exploitation%201f6ab152e9b44ed5bdde9b2f82e11f9e/Untitled%201.png)

[](https://ithelp.ithome.com.tw/articles/10189201)

# CaaS ( Node.js, js code understanding )

---

![Untitled](Web%20Exploitation%201f6ab152e9b44ed5bdde9b2f82e11f9e/Untitled%202.png)

From this code we can identify that it is a node application ( a application server running javascript based thing )

```bash
const express = require('express');
const app = express();
const { exec } = require('child_process');

app.use(express.static('public'));

app.get('/cowsay/:message', (req, res) => {
  exec(`/usr/games/cowsay ${req.params.message}`, {timeout: 5000}, (error, stdout) => {
    if (error) return res.status(500).end();
    res.type('txt').send(stdout).end();
  });
});

app.listen(3000, () => {
  console.log('listening');
});
```

# **More Cookies ( CBC bitflip, python )**

---

```python
from base64 import b64decode
from base64 import b64encode
import requests

def bitFlip( pos:int, bit:int, data:bytearray) -> str:
    
    data[pos] = data[pos] ^ bit
    b64_data = b64encode(data) # bytes
    return b64_data.decode("utf-8") # string

orig_cookie = b64decode("N2gyK01nRnZ3VmxPdkp5dUJoK0NFMGozSi9hazVsbS9BVkZPbzdLclplQmc4eG16VVZKbGtyYTg3WDJzYlNLd28vZW5GdW03cHNUakhlVVQ0VVhpS0pFNmdaWDhOSC9adXRwWnlPUTZKVWszczh5emQxemduSHpnSys4bVQ2YWU=")
deco_cookie = bytearray(orig_cookie)

for i in range(128):
    for j in range(128):
        print("Get in i = ", i, " j = ", j)
        c = bitFlip(i, j, deco_cookie)
        cookies = {'auth_name': c}
        r = requests.get('http://mercury.picoctf.net:56136/', cookies=cookies)
        if "picoCTF{".lower() in r.text.lower():
            print(r.text)
            break
```

# **Some Assembly Required 1 (WASM)**

---

![Untitled](Web%20Exploitation%201f6ab152e9b44ed5bdde9b2f82e11f9e/Untitled%203.png)

# It is my birthday (md5 collision)

---

[Peter Selinger: MD5 Collision Demo](https://www.mscs.dal.ca/~selinger/md5collision/)

# **Most Cookies (Flask cookie decode)**

---

[](https://github.com/Paradoxis/Flask-Unsign/blob/master/README.md)

# More SQLi (**SQLiLite, sqlite_master)**

---

[SQLite: System Tables](https://www.techonthenet.com/sqlite/sys_tables/index.php)

# **Irish-Name-Repo 2 (SQLi)**

---

`SQL query: SELECT * FROM users WHERE name='admin'--' AND password=''`

we can add `‘--` to name so the password check is bypassed

# **Web Gauntlet (SQLi)**

---

[](https://github.com/onealmond/hacking-lab/blob/master/picoctf-2020/web-gauntlet/writeup.md)

# Dangerous function in PHP Python and Javascript

---

![Untitled](Web%20Exploitation%201f6ab152e9b44ed5bdde9b2f82e11f9e/Untitled%204.png)